---
import {Image} from "astro:assets";
import logo from "../assets/images/Logo.png";
import Cart from "../assets/images/Cart-White.svg";

const navLinks = [
    {name: "Team", href: "/team"},
    {name: "Gallery", href: "/gallery"},
    {name: "Piercing Parlour", href: "/piercing-parlour"},
    {name: "Shop", href: "/shop"},
    {name: "Contact Us", href: "/contact-us"},
];

// get current path
const currentPath = Astro.url.pathname;
---

<nav class="fixed top-0 left-0 w-full shadow-md z-50 border-b-2 border-red bg-black text-white">
    <div class="max-w-full mx-auto px-6 md:px-10 py-2 flex items-center justify-between">
        <div class="flex items-center">
            <a href="/" title="Go to Home" aria-label="Go to top">
                <Image src={logo} alt="Logo" width={56} height={56} class="mr-3 md:mr-6"/>
            </a>
            <a
                    href="/"
                    title="Go to Home"
                    class="hidden md:inline-block relative group text-xl md:text-2xl text-white hover:text-red transition-colors"
            >
                Black Cat Tattoo & Piercing Parlour
                <span
                        class="absolute left-0 -bottom-1 w-0 h-1 bg-red group-hover:w-full transition-all"
                ></span>
            </a>
        </div>

        <ul class="hidden md:flex gap-8 text-lg md:text-2xl items-center">
            {navLinks.map(link => (
                    <li>
                        <a
                                href={link.href}
                                class={`relative group transition-colors ${
                                    currentPath === link.href
                                        ? "text-red"
                                        : "text-white hover:text-red"
                                }`}
                        >
                            {link.name}
                            <span
                                    class={`absolute left-0 -bottom-1 h-1 transition-all ${
                                        currentPath === link.href ? "w-full bg-red" : "w-0 bg-red group-hover:w-full"
                                    }`}
                            ></span>
                        </a>
                    </li>
            ))}
            <button
                    type="button"
                    onclick="window.location.href='/cart'"
                    id="cart-button"
                    class="flex items-center justify-center w-10 h-10 rounded-md hover:bg-red border border-2 border-grey"
                    title="Open menu"
            >
                <Image src={Cart} alt="Cart" width={24} height={24} class="w-6 h-6 fill-white"/>
            </button>
        </ul>


        <div class="md:hidden relative flex gap-4">
            <button
                    type="button"
                    onclick="window.location.href='/cart'"
                    id="cart-button"
                    class="flex items-center justify-center w-10 h-10 rounded-md hover:bg-red border border-2 border-grey"
                    title="Open menu"
            >
                <Image src={Cart} alt="Cart" width={24} height={24} class="w-6 h-6 fill-white"/>
            </button>

            <button
                    id="menu-button"
                    aria-expanded="false"
                    aria-controls="dropdown-menu"
                    class="flex items-center justify-center w-10 h-10 border border-2 border-grey rounded-md focus:outline-none focus:ring-2 focus:ring-red"
                    title="Open menu"
            >
                <span class="sr-only">Open menu</span>
                <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>

            <div
                    id="dropdown-menu"
                    class="hidden absolute right-0 mt-2 w-48 bg-black text-white rounded-md shadow-lg flex-col divide-y divide-gray-800 max-h-60 overflow-auto p-1 z-50"
                    role="menu"
                    aria-labelledby="menu-button"
            >
                {navLinks.map(link => (
                        <a
                                role="menuitem"
                                href={link.href}
                                class={`text-lg block w-full text-left px-4 py-3 rounded-md transition-colors ${
                                    currentPath === link.href
                                        ? "bg-red text-black"
                                        : "hover:bg-amber-500 hover:text-black"
                                }`}
                        >
                            {link.name}
                        </a>
                ))}
            </div>
        </div>
    </div>
</nav>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("menu-button");
        const menu = document.getElementById("dropdown-menu");

        const openMenu = () => {
            menu.classList.remove("hidden");
            btn.setAttribute("aria-expanded", "true");
        };
        const closeMenu = () => {
            menu.classList.add("hidden");
            btn.setAttribute("aria-expanded", "false");
        };

        btn.addEventListener("click", (e) => {
            e.stopPropagation();
            if (menu.classList.contains("hidden")) openMenu();
            else closeMenu();
        });

        document.addEventListener("click", (e) => {
            if (!btn.contains(e.target) && !menu.contains(e.target)) closeMenu();
        });

        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape") closeMenu();
        });
    });
</script>
